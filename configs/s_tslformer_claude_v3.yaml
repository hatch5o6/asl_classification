# TSLFormer-inspired configuration for skeleton-only ASL classification
# v3: L0 annealing - gradual increase in sparsity pressure
#
# Key changes from v2:
# 1. l0_anneal_steps: 15000 (ramp L0 from 0 to target over 15k steps after warmup)
# 2. l0_end_weight: 0.001 (stronger final L0 than v2's 0.0001)
#
# Training schedule:
# - Steps 0-5000: No L0 penalty (warmup - learn which joints matter)
# - Steps 5000-20000: L0 ramps 0 â†’ 0.001 (gradual pruning pressure)
# - Steps 20000+: Full L0 at 0.001 (maintain sparsity)

save: /home/hatch5o6/groups/grp_asl_classification/nobackup/archive/SLR/models/s_tslformer_claude_v3
test_checkpoint: null
modalities: ["skeleton"]
joint_pruning: True

train_csv: data/train.csv
val_csv: data/val.csv
test_csv: data/test.csv
class_id_csv: data/SignList_ClassId_TR_EN.csv

seed: 4000

n_gpus: 4
device: cuda

# Learning rates
pretrained_learning_rate: 5e-05
new_learning_rate: 1e-04
skel_learning_rate: 1e-04
class_learning_rate: 1e-04
weight_decay: 0.01

# Training schedule
effective_batch_size: 32
early_stop: 10
save_top_k: 10
val_interval: 0.25
max_steps: 200000

# Architecture - TSLFormer-inspired
fusion_dim: 512
depth_image_size: 224
depth_hidden_dim: 384
depth_hidden_layers: 6
depth_att_heads: 6
depth_intermediate_size: 1536
depth_patch_size: 16

# BERT Skeleton Encoder
bert_hidden_layers: 2
bert_hidden_dim: 512
bert_att_heads: 8
bert_intermediate_size: 2048

# Joint pruning configuration - L0 ANNEALING
num_pose_points: 543
init_keep_probability: 0.9  # Start with all joints
l0_warmup_steps: 5000       # No L0 for first 5k steps
l0_anneal_steps: 15000      # Ramp L0 over next 15k steps (5k-20k)
l0_end_weight: 0.001        # Final L0 weight (10x stronger than v2)
classifier_dropout: 0.2

gradient_clip_val: 1.0
