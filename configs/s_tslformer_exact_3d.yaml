# TSLFormer EXACT REPLICA with 3D coordinates (X, Y, Z)
# Based on s_tslformer_exact.yaml but includes Z coordinate
#
# Key change: use_z_coord: True adds depth information to skeleton data

save: /home/hatch5o6/groups/grp_asl_classification/nobackup/archive/SLR/models/s_tslformer_exact_3d
test_checkpoint: null
modalities: ["skeleton"]

# TSLFormer uses MANUAL joint selection (not learned pruning)
joint_pruning: False
use_tslformer_joints: True  # Manual 543 â†’ 50 joint selection

# NEW: Include Z coordinate (3D skeleton data)
use_z_coord: True
num_coords: 3  # X, Y, Z (vs default 2 for X, Y only)

train_csv: data/train.csv
val_csv: data/val.csv
test_csv: data/test.csv
class_id_csv: data/SignList_ClassId_TR_EN.csv

seed: 4000

n_gpus: 4
device: cuda

# Learning rates
pretrained_learning_rate: 5e-05
new_learning_rate: 1e-04
skel_learning_rate: 1e-04
class_learning_rate: 1e-04
weight_decay: 0.01

# Training schedule
effective_batch_size: 32
early_stop: 10
save_top_k: 10
val_interval: 0.25
max_steps: 200000

# Architecture
fusion_dim: 512
depth_image_size: 224
depth_hidden_dim: 384
depth_hidden_layers: 6
depth_att_heads: 6
depth_intermediate_size: 1536
depth_patch_size: 16

# BERT Skeleton Encoder - EXACT TSLFormer
bert_hidden_layers: 2
bert_hidden_dim: 512
bert_att_heads: 8
bert_intermediate_size: 2048

# Joint configuration
# Input size: 50 joints * 3 coords = 150 features (vs 100 for 2D)
num_pose_points: 50
init_keep_probability: 0.9
classifier_dropout: 0.2

gradient_clip_val: 1.0
